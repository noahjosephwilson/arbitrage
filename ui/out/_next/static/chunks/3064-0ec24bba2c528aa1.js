"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3064],{3064:(e,t,i)=>{function n(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]=i[n]}return e}i.d(t,{E:()=>q});var r=function e(t,i){function r(e,r,s){if("undefined"!=typeof document){"number"==typeof(s=n({},i,s)).expires&&(s.expires=new Date(Date.now()+864e5*s.expires)),s.expires&&(s.expires=s.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var d="";for(var a in s)s[a]&&(d+="; "+a,!0!==s[a]&&(d+="="+s[a].split(";")[0]));return document.cookie=e+"="+t.write(r,e)+d}}return Object.create({set:r,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var i=document.cookie?document.cookie.split("; "):[],n={},r=0;r<i.length;r++){var s=i[r].split("="),d=s.slice(1).join("=");try{var a=decodeURIComponent(s[0]);if(n[a]=t.read(d,a),e===a)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){r(e,"",n({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,n({},this.attributes,t))},withConverter:function(t){return e(n({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(i)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});class s{constructor(e={}){let{path:t,domain:i,expires:n,sameSite:r,secure:s}=e;if(this.domain=i,this.path=t||"/",this.expires=Object.prototype.hasOwnProperty.call(e,"expires")?n:365,this.secure=!Object.prototype.hasOwnProperty.call(e,"secure")||s,Object.prototype.hasOwnProperty.call(e,"sameSite")){if(!r||!["strict","lax","none"].includes(r))throw Error('The sameSite value of cookieStorage must be "lax", "strict" or "none".');if("none"===r&&!this.secure)throw Error("sameSite = None requires the Secure attribute in latest browser versions.");this.sameSite=r}}async setItem(e,t){r.set(e,t,this.getData())}async getItem(e){return r.get(e)??null}async removeItem(e){r.remove(e,this.getData())}async clear(){let e=Object.keys(r.get()).map(e=>this.removeItem(e));await Promise.all(e)}getData(){return{path:this.path,expires:this.expires,domain:this.domain,secure:this.secure,...this.sameSite&&{sameSite:this.sameSite}}}}var d=i(319),a=i(7648),o=i(468),c=i(9293);i(670),i(8021);var l=i(8352),h=i(1851),y=i(2954),I=i(9096),u=i(7364),g=i(3299),p=i(4172),C=i(9896),f=i(8800),m=i(2590),w=i(6728);let v=(0,m.q)(u.F,[()=>e=>async function(t){return t.headers["cache-control"]="no-store",e(t)}]),A={service:"cognito-identity",endpointResolver:({region:e})=>({url:new C.o(`https://cognito-identity.${e}.${(0,I.R)(e)}`)}),retryDecider:(0,p.D)(h.F),computeDelay:g.y,userAgentValue:(0,f.fE)(),cache:"no-store"};(0,w.e9)(()=>{A.userAgentValue=(0,f.fE)()});let S=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityService.${e}`}),_=({url:e},t,i)=>({headers:t,url:e,body:i,method:"POST"}),k=async e=>{if(e.statusCode>=300)throw await (0,h.F)(e);{let t=await (0,h.Y)(e);return{IdentityId:t.IdentityId,Credentials:T(t.Credentials),$metadata:(0,l.j)(e)}}},T=({AccessKeyId:e,SecretKey:t,SessionToken:i,Expiration:n}={})=>({AccessKeyId:e,SecretKey:t,SessionToken:i,Expiration:n&&new Date(1e3*n)}),x=(0,y.A)(v,(e,t)=>_(t,S("GetCredentialsForIdentity"),JSON.stringify(e)),k,A);var K=i(8785),b=i(5199),E=i(2),O=i(9492),P=i(2193);let D=async e=>{if(!(e.statusCode>=300))return{IdentityId:(await (0,h.Y)(e)).IdentityId,$metadata:(0,l.j)(e)};throw await (0,h.F)(e)},R=(0,y.A)(v,(e,t)=>_(t,S("GetId"),JSON.stringify(e)),D,A);function j(e){let t=(0,K.Cq)(e).payload.iss,i={};if(!t)throw new b.l({name:"InvalidIdTokenException",message:"Invalid Idtoken."});return i[t.replace(/(^\w+:|^)\/\//,"")]=e,i}async function F({tokens:e,authConfig:t,identityIdStore:i}){i.setAuthConfig({Cognito:t});let n=await i.loadIdentityId();if(n)return n.id;let r=e?.idToken?j(e.idToken.toString()):{},s=await G(r,t);return i.storeIdentityId({id:s,type:e?"primary":"guest"}),s}async function G(e,t){let i,n=t?.identityPoolId,r=(0,O.C)(n);try{i=(await R({region:r},{IdentityPoolId:n,Logins:e})).IdentityId}catch(e){throw(0,E.e)(e),new b.l(e)}if(!i)throw new b.l({name:"GetIdResponseException",message:"Received undefined response from getId operation",recoverySuggestion:"Make sure to pass a valid identityPoolId in the configuration."});return i}let L=new c.C("CognitoCredentialsProvider");class V{constructor(e){this._nextCredentialsRefresh=0,this._identityIdStore=e}async clearCredentialsAndIdentityId(){L.debug("Clearing out credentials and identityId"),this._credentialsAndIdentityId=void 0,await this._identityIdStore.clearIdentityId()}async clearCredentials(){L.debug("Clearing out in-memory credentials"),this._credentialsAndIdentityId=void 0}async getCredentialsAndIdentityId(e){let t=e.authenticated,{tokens:i}=e,{authConfig:n}=e;try{(0,K.Eh)(n?.Cognito)}catch{return}if(!t&&!n.Cognito.allowGuestAccess)return;let{forceRefresh:r}=e,s=this.hasTokenChanged(i),d=await F({tokens:i,authConfig:n.Cognito,identityIdStore:this._identityIdStore});return((r||s)&&this.clearCredentials(),t)?((0,P.OW)(i),this.credsForOIDCTokens(n.Cognito,i,d)):this.getGuestCredentials(d,n.Cognito)}async getGuestCredentials(e,t){let i;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&!1===this._credentialsAndIdentityId.isAuthenticatedCreds)return L.info("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();let n=(0,O.C)(t.identityPoolId);try{i=await x({region:n},{IdentityId:e})}catch(e){throw(0,E.e)(e),new b.l(e)}if(i?.Credentials?.AccessKeyId&&i?.Credentials?.SecretKey){this._nextCredentialsRefresh=new Date().getTime()+3e6;let t={credentials:{accessKeyId:i.Credentials.AccessKeyId,secretAccessKey:i.Credentials.SecretKey,sessionToken:i.Credentials.SessionToken,expiration:i.Credentials.Expiration},identityId:e};return i.IdentityId&&(t.identityId=i.IdentityId,this._identityIdStore.storeIdentityId({id:i.IdentityId,type:"guest"})),this._credentialsAndIdentityId={...t,isAuthenticatedCreds:!1},t}throw new b.l({name:"CredentialsNotFoundException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}async credsForOIDCTokens(e,t,i){let n;if(this._credentialsAndIdentityId&&!this.isPastTTL()&&!0===this._credentialsAndIdentityId.isAuthenticatedCreds)return L.debug("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();let r=t.idToken?j(t.idToken.toString()):{},s=(0,O.C)(e.identityPoolId);try{n=await x({region:s},{IdentityId:i,Logins:r})}catch(e){throw(0,E.e)(e),new b.l(e)}if(n?.Credentials?.AccessKeyId&&n?.Credentials?.SecretKey){this._nextCredentialsRefresh=new Date().getTime()+3e6;let e={credentials:{accessKeyId:n.Credentials.AccessKeyId,secretAccessKey:n.Credentials.SecretKey,sessionToken:n.Credentials.SessionToken,expiration:n.Credentials.Expiration},identityId:i};return n.IdentityId&&(e.identityId=n.IdentityId,this._identityIdStore.storeIdentityId({id:n.IdentityId,type:"primary"})),this._credentialsAndIdentityId={...e,isAuthenticatedCreds:!0,associatedIdToken:t.idToken?.toString()},e}throw new b.l({name:"CredentialsException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}isPastTTL(){return void 0===this._nextCredentialsRefresh||this._nextCredentialsRefresh<=Date.now()}hasTokenChanged(e){return!!e&&!!this._credentialsAndIdentityId?.associatedIdToken&&e.idToken?.toString()!==this._credentialsAndIdentityId.associatedIdToken}}var H=i(4886);let U={identityId:"identityId"},N=new c.C("DefaultIdentityIdStore");class ${setAuthConfig(e){(0,K.Eh)(e.Cognito),this.authConfig=e,this._authKeys=Q("Cognito",e.Cognito.identityPoolId)}constructor(e){this._authKeys={},this._hasGuestIdentityId=!1,this.keyValueStorage=e}async loadIdentityId(){(0,K.Eh)(this.authConfig?.Cognito);try{if(this._primaryIdentityId)return{id:this._primaryIdentityId,type:"primary"};{let e=await this.keyValueStorage.getItem(this._authKeys.identityId);if(e)return this._hasGuestIdentityId=!0,{id:e,type:"guest"};return null}}catch(e){return N.log("Error getting stored IdentityId.",e),null}}async storeIdentityId(e){(0,K.Eh)(this.authConfig?.Cognito),"guest"===e.type?(this.keyValueStorage.setItem(this._authKeys.identityId,e.id),this._primaryIdentityId=void 0,this._hasGuestIdentityId=!0):(this._primaryIdentityId=e.id,this._hasGuestIdentityId&&(this.keyValueStorage.removeItem(this._authKeys.identityId),this._hasGuestIdentityId=!1))}async clearIdentityId(){this._primaryIdentityId=void 0,await this.keyValueStorage.removeItem(this._authKeys.identityId)}}let Q=(e,t)=>(0,H.Qm)(U)(`com.amplify.${e}`,t),z=new V(new $(d.ZL));var B=i(4572);let q={configure(e,t){let i=(0,o.M)(e),n=new s({sameSite:"lax"}),r=t?.ssr?n:d.ZL,c=t?.ssr?new V(new $(n)):z;if(!i.Auth||t?.Auth)return void a.H.configure(i,t);if(!a.H.libraryOptions.Auth){B.Q.setAuthConfig(i.Auth),B.Q.setKeyValueStorage(r),a.H.configure(i,{...t,Auth:{tokenProvider:B.Q,credentialsProvider:c}});return}if(t){let e=a.H.libraryOptions.Auth;void 0!==t.ssr&&(B.Q.setKeyValueStorage(r),e.credentialsProvider=c),a.H.configure(i,{Auth:e,...t});return}a.H.configure(i)},getConfig:()=>a.H.getConfig()}}}]);